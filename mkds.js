var namespace = "http://www.w3.org/2000/svg"
var banisher = makeImage("http://vignette3.wikia.nocookie.net/mario/images/3/3d/Banisher_-_Kart_Select_%28Dry_Bones%29_-_Mario_Kart_DS.png/revision/latest?cb=20120616140312", 73, 0, 190, 50 )
var drybomber = makeImage("http://vignette4.wikia.nocookie.net/mario/images/d/de/Dry_Bomber_-_Select_Kart_%28Dry_Bones%29_-_Mario_Kart_DS.png/revision/latest?cb=20120616140732", 3, 0, 190, 50)
var robbls = makeImage("http://vignette4.wikcia.nocookie.net/mariokart/images/d/df/ROB-BLS.jpg/revision/latest?cb=20090209020814", -65, 0, 190, 50)
var roblgs = makeImage("https://vignette3.wikia.nocookie.net/mario/images/6/65/ROB-LGSMKDS.png/revision/latest?cb=20160122025320", 141, 0, 190, 50)
var bdasher = makeImage("http://vignette2.wikia.nocookie.net/nintendo/images/2/27/B_Dasher_%28Mario_Kart_DS%29.png/revision/latest?cb=20121001001207&path-prefix=en", 3, 52, 190, 50)
var shootingstar = makeImage("http://vignette2.wikia.nocookie.net/mario/images/4/4c/MKDS_Shooting_Star.png/revision/latest?cb=20110910184056", 141, 52, 190, 50)
var poltergust = makeImage("http://vignette2.wikia.nocookie.net/mario/images/b/b3/MKDS_Poltergust_4000_2.png/revision/latest/scale-to-width-down/185?cb=20110801152823", -65, 52, 190, 50)
var streamliner = makeImage("http://vignette3.wikia.nocookie.net/mariokart/images/e/e6/Luigistreamliner45.PNG/revision/latest?cb=20101009212543", 73, 52, 190, 50)
var brute = makeImage("http://vignette1.wikia.nocookie.net/mariokart/images/6/61/Wariobrute33.PNG/revision/latest?cb=20101009212544", -65, 104, 190, 50)
var dragonfly = makeImage("https://duckduckgo.com/i/4133109f.png", 3, 104, 190, 50)
var zipper = makeImage("https://vignette2.wikia.nocookie.net/mariokart/images/3/3f/180px-Zipper.jpg/revision/latest?cb=20100801210418", 73, 104, 190, 50)
var goldmantis = makeImage("https://vignette2.wikia.nocookie.net/mariokart/images/3/3f/180px-Zipper.jpg/revision/latest?cb=20100801210418", 141, 104, 190, 50)
var cucumber = makeImage("http://vignette1.wikia.nocookie.net/mario/images/2/23/Cucumber_with_Yoshi_-_Mario_Kart_DS.png/revision/latest?cb=20120901210237", 3, 156, 190, 50)
var egg1 = makeImage("http://vignette2.wikia.nocookie.net/mariokart/images/0/0f/Egg_1.jpg/revision/latest?cb=20081007120021", 73, 156, 190, 50)
var mushmellow = makeImage("http://vignette1.wikia.nocookie.net/mariokart/images/8/8f/Mushmellowmkds.PNG/revision/latest?cb=20101009204720", -65, 156, 190, 50)
var wheelcradle = makeImage("http://vignette1.wikia.nocookie.net/mario/images/9/96/4-Wheel_Cradle_-_Kart_Select_%28Toad%29_-_Mario_Kart_DS.png/revision/latest?cb=20120616202451", 141, 156, 190, 50)
var lighttripper = makeImage("https://duckduckgo.com/i/a89cc98f.jpg", 3,208,190,50 )
var royale = makeImage("http://www.gamehiker.com/wiki/images/thumb/f/fa/Royale.jpg/200px-Royale.jpg",141,208,190,50 )
var flowerpower = makeImage("https://vignette4.wikia.nocookie.net/mario/images/3/30/Power_Flower.png/revision/latest?cb=20140615013203", 73,208,190,50)
var lightdancer = makeImage("http://vignette1.wikia.nocookie.net/we-are-daisy/images/7/75/MKDS_Light_dancer.PNG/revision/latest/scale-to-width-down/185?cb=20160826115618", -65,208,190,50)
var wildlife = makeImage("https://vignette2.wikia.nocookie.net/fictionalcrossover/images/f/f5/MKDS_Wildlife.png/revision/latest/scale-to-width-down/185?cb=20130323150310", 141,260,190,50)
var rambirider = makeImage("http://www.gamehiker.com/wiki/images/thumb/f/f4/Rambirider.jpg/150px-Rambirider.jpg", 73, 260, 190, 50)
var tyrant = makeImage("https://vignette2.wikia.nocookie.net/mariokart/images/f/f7/Bowsertyrant00.PNG/revision/latest/scale-to-width-down/250?cb=20101009212542",-65, 260,190,50)
var hurricane = makeImage("http://vignette1.wikia.nocookie.net/mariokart/images/e/e3/Bowserhurricane23.PNG/revision/latest?cb=20101009212541", 3, 260, 190, 50)
var mario2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6316.png", -65, 322, 190, 40)
var x = getX(mario2)
var luigi2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6383.png", -22, 352, 190, 40)
var x = getX(luigi2)
var peach2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6394.png", 13, 322, 190, 40)
var x = getX(peach2)
var yoshi2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6283.png", 52, 352, 190, 40)
var x = getX(yoshi2)
var toad2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6379.png", 92, 322, 190, 40)
var x = getX(toad2)
var dk2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6382.png", 134, 352, 190, 40)
var x = getX(dk2)
var wario2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6371.png", -65, 382, 190, 40)
var x = getX(wario2)
var bowser2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6380.png", 13, 382, 190, 40)
var x = getX(bowser2)
var daisy2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6384.png", 92, 382, 190, 40)
var x = getX(daisy2)
var bones2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6391.png", -22, 412, 190, 40)
var x = getX(bones2)
var waluigi2 = makeImage("https://www.models-resource.com/resources/big_icons/7/6377.png", 52, 412, 190, 40)
var x = getX(waluigi2)
var rob = makeImage("https://www.models-resource.com/resources/big_icons/7/6392.png", 134, 412, 190, 40)
var x = getX(rob)
var bulletbill = makeImage("http://vignette2.wikia.nocookie.net/mariokart/images/2/20/Bullet_Bill%2C_Super_Mario_3D_Land.png/revision/latest?cb=20130623114153", 3, 452, 190, 50)
var blooper = makeImage("https://upload.wikimedia.org/wikipedia/commons/4/43/Blooper.png", 76, 452, 190, 40)
addEventListener("keydown", movemario2)
function movemario2(event) {
  var x = getX(mario2)
  if (event.key == "a") {
  move(mario2, -3, 0)
  } if (event.key == "d") {
    move(mario2, 3, 0)
  } if (event.key == "w") {
    move(mario2, 0, -3)
  } if (event.key == "s") {
    move(mario2, 0, 3)
  } if (x > 300) {
  }
}
  addEventListener("keydown", movewario2)
  function movewario2(event) {
    var x = getX(wario2)
    if (event.key == "r") {
    move(wario2, -3, 0)
  } if (event.key == "e") {
    move(wario2, 3, 0)
  } if (event.key == "q") {
    move(wario2, 0, -3)
  } if (event.key == "2") {
    move(wario2, 0, 3)
  } if (x > 300) {

  }
  }
  addEventListener("keydown", movebowser2)
  function movebowser2(event) {
    var x = getX(bowser2)
    if (event.key == "h") {
    move(bowser2, -3, 0)
  } if (event.key == "m") {
    move(bowser2, 3, 0)
  } if (event.key == "j") {
    move(bowser2, 0, -3)
  } if (event.key == "n") {
    move(bowser2, 0, 3)
  } if (x > 300) {
  }
}
addEventListener("keydown", moveluigi2)
function moveluigi2(event) {
  var x = getX(luigi2)
  if (event.key == "k") {
  move(luigi2, -3, 0)
} if (event.key == "l") {
  move(luigi2, 3, 0)
} if (event.key == "p") {
  move(luigi2, 0, -3)
} if (event.key == "o") {
  move(luigi2, 0, 3)
} if (x > 300) {
}
}
addEventListener("keydown", movedk2)
function movedk2(event) {
  var x = getX(dk2)
  if (event.key == "i") {
  move(dk2, -3, 0)
} if (event.key == "u") {
  move(dk2, 3, 0)
} if (event.key == "8") {
  move(dk2, 0, -3)
} if (event.key == "7") {
  move(dk2, 0, 3)
} if (x > 300) {
}
}
addEventListener("keydown", moveyoshi2)
function moveyoshi2(event) {
  var x = getX(yoshi2)
  if (event.key == "t") {
  move(yoshi2, -3, 0)
} if (event.key == "z") {
  move(yoshi2, 3, 0)
} if (event.key == "c") {
  move(yoshi2, 0, -3)
} if (event.key == "x") {
  move(yoshi2, 0, 3)
} if (x > 300) {
}
}
addEventListener("keydown", movepeach2)
function movepeach2(event) {
  var x = getX(peach2)
  if (event.key == "g") {
  move(peach2, -3, 0)
} if (event.key == "f") {
  move(peach2, 3, 0)
} if (event.key == "v") {
  move(peach2, 0, -3)
} if (event.key == "b") {
  move(peach2, 0, 3)
} if (x > 300) {
}
}
addEventListener("keydown", movetoad2)
function movetoad2(event) {
  var x = getX(toad2)
  if (event.key == "0") {
  move(toad2, -3, 0)
} if (event.key == "9") {
  move(toad2, 3, 0)
} if (event.key == "3") {
  move(toad2, 0, -3)
} if (event.key == "1") {
  move(toad2, 0, 3)
} if (x > 300) {
}
}

function getX(shape) {
  if (!shape) {
    throw "Uh oh, you tried to get the x coordinate of a shape that doesn't exist!"
  }
  try {
    if (shape.hasAttribute("x")) {
      return parseFloat(shape.getAttribute("x"))
    } else if (shape.hasAttribute("cx")) {
      return parseFloat(shape.getAttribute("cx"))
    }  else if (shape.hasAttribute("x1")) {
      return parseFloat(shape.getAttribute("x1"))
    }
  } catch(err) {
    throw "You're trying to get the x coordinate of something that isn't a shape!"
  }
}

function getY(shape) {
  if (!shape) {
    throw "Uh oh, you tried to get the y coordinate of a shape that doesn't exist!"
  }
  try {
    if (shape.hasAttribute("y")) {
      return parseFloat(shape.getAttribute("y"))
    } else if (shape.hasAttribute("cy")) {
      return parseFloat(shape.getAttribute("cy"))
    } else if (shape.hasAttribute("y1")) {
      return parseFloat(shape.getAttribute("y1"))
    }
  } catch (err) {
    throw "You're trying to get the y coordinate of something that isn't a shape!"
  }
}

function setX(shape, x) {
  if (!shape) {
    throw "I can't set the x of a shape that doesn't exist!"
  }
  if (isNaN(x)) {
    throw "You need to tell me what to set the x coordinate to!"
  }
  if (shape.hasAttribute("x")) {
    shape.setAttribute("x", x)
  } else if (shape.hasAttribute("cx")) {
    shape.setAttribute("cx", x)
  } else if (shape.hasAttribute("x1")) {
    var xDiff = parseFloat(shape.getAttribute("x2")) - parseFloat(shape.getAttribute("x1"))
    shape.setAttribute("x1", x)
    shape.setAttribute("x2", x + xDiff)
  }
}

function setY(shape, y) {
  if (!shape) {
    throw "I can't set the y of a shape that doesn't exist!"
  }
  if (isNaN(y)) {
    throw "You need to tell me what to set the y coordinate to!"
  }
  if (shape.hasAttribute("y")) {
    shape.setAttribute("y", y)
  } else if (shape.hasAttribute("cy")) {
    shape.setAttribute("cy", y)
  } else if (shape.hasAttribute("y1")) {
    var yDiff = parseFloat(shape.getAttribute("y2")) - parseFloat(shape.getAttribute("y1"))
    shape.setAttribute("y1", y)
    shape.setAttribute("y2", y + yDiff)
  }
}

function move(shape, dx, dy) {
  if (!shape) {
    throw "I can't move a shape that doesn't exist!"
  }
  if (isNaN(dx)) {
    throw "You need to tell me how much to move the shape in the x direction!"
  }
  if (isNaN(dy)) {
    throw "You need to tell me how much to move the shape in the y direction!"
  }
  if (shape.hasAttribute("x") && shape.hasAttribute("y")) {
    var x = parseFloat(shape.getAttribute("x"))
    var y = parseFloat(shape.getAttribute("y"))
    shape.setAttribute("x", x + dx)
    shape.setAttribute("y", y + dy)
  } else if (shape.hasAttribute("cx")) {
    var cx = parseFloat(shape.getAttribute("cx"))
    var cy = parseFloat(shape.getAttribute("cy"))
    shape.setAttribute("cx", cx + dx)
    shape.setAttribute("cy", cy + dy)
  } else if (shape.hasAttribute("x1")) {
    var x1 = parseFloat(shape.getAttribute("x1"))
    var y1 = parseFloat(shape.getAttribute("x1"))
    setX(shape, x1 + dx)
    setY(shape, y1 + dy)
  }
}

function makeCircle(cx, cy, r, fill, opacity) {
  var circle = document.createElementNS(namespace, "circle")
  circle.setAttribute("cx", cx)
  circle.setAttribute("cy", cy)
  circle.setAttribute("r", r)
  circle.setAttribute("fill", fill)
  circle.setAttribute("opacity", opacity)

  var canvas = document.getElementById("canvas")
  canvas.appendChild(circle)
  return circle
}

function makeRect(x, y, width, height, fill, opacity) {
  var rect = document.createElementNS(namespace, "rect")
  rect.setAttribute("x", x)
  rect.setAttribute("y", y)
  rect.setAttribute("width", width)
  rect.setAttribute("height", height)
  rect.setAttribute("fill", fill)
  rect.setAttribute("opacity", opacity)

  var canvas = document.getElementById("canvas")
  canvas.appendChild(rect)
  return rect
}

function makeEllipse(cx, cy, rx, ry, fill, opacity) {
  var ellipse = document.createElementNS(namespace, "ellipse")
  ellipse.setAttribute("cx", cx)
  ellipse.setAttribute("cy", cy)
  ellipse.setAttribute("rx", rx)
  ellipse.setAttribute("ry", ry)
  ellipse.setAttribute("fill", fill)
  ellipse.setAttribute("opacity", opacity)

  var canvas = document.getElementById("canvas")
  canvas.appendChild(ellipse)
  return ellipse
}

function makeLine(x1, y1, x2, y2, stroke, strokeWidth, opacity) {
  var line = document.createElementNS(namespace, "line")
  line.setAttribute("x1", x1)
  line.setAttribute("y1", y1)
  line.setAttribute("x2", x2)
  line.setAttribute("y2", y2)
  line.setAttribute("stroke", stroke)
  line.setAttribute("stroke-width", strokeWidth)
  line.setAttribute("opacity", opacity)

  var canvas = document.getElementById("canvas")
  canvas.appendChild(line)
  return line
}

function makePolyline(points, stroke, strokeWidth, opacity) {
  var polyline = document.createElementNS(namespace, "polyline")
  polyline.setAttribute("points", points)
  polyline.setAttribute("stroke", stroke)
  polyline.setAttribute("stroke-width", strokeWidth)
  polyline.setAttribute("opacity", opacity)
  polyline.setAttribute("fill", "none")

  var canvas = document.getElementById("canvas")
  canvas.appendChild(polyline)
  return polyline
}

function makePolygon(points, fill, opacity) {
  var polygon = document.createElementNS(namespace, "polygon")
  polygon.setAttribute("points", points)
  polygon.setAttribute("opacity", opacity)
  polygon.setAttribute("fill", fill)

  var canvas = document.getElementById("canvas")
  canvas.appendChild(polygon)
  return polygon
}

function makeText(message, x, y, fontSize, fontFamily, fill, opacity) {
  var text = document.createElementNS(namespace, "text")
  text.innerHTML = message
  text.setAttribute("x", x)
  text.setAttribute("y", y)
  text.setAttribute("font-size", fontSize)
  text.setAttribute("font-family", fontFamily)
  text.setAttribute("fill", fill)
  text.setAttribute("opacity", opacity)

  var canvas = document.getElementById("canvas")
  canvas.appendChild(text)
  return text
}

function makeImage(url, x, y, width, height, opacity) {
  var image = document.createElementNS(namespace, "image")
  image.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", url)
  image.setAttribute("x", x)
  image.setAttribute("y", y)
  image.setAttribute("width", width)
  image.setAttribute("height", height)
  image.setAttribute("opacity", opacity)

  var canvas = document.getElementById("canvas")
  canvas.appendChild(image)
  return image
}

function collides(shape1, shape2) {
  var centerX, centerY
  if (shape1.hasAttribute("x")) {
    centerX = getX(shape1) + parseFloat(shape1.getAttribute("width"))/2
    centerY = getY(shape1) + parseFloat(shape1.getAttribute("height"))/2
  } else if (shape1.hasAttribute("cx")) {
    centerX = getX(shape1)
    centerY = getY(shape1)
  } else {
    throw "Oops, that kind of shape isn't supported by the collide function!"
  }

  var xMin, xMax, yMin, yMax
  if (shape2.hasAttribute("x")) {
    xMin = getX(shape2)
    yMin = getY(shape2)
    xMax = getX(shape2) + parseFloat(shape2.getAttribute("width"))
    yMax = getY(shape2) + parseFloat(shape2.getAttribute("height"))
  } else if (shape2.hasAttribute("cx")) {
    if (shape2.hasAttribute("rx")) {
      var rx = parseFloat(shape2.getAttribute("rx"))
      var ry = parseFloat(shape2.getAttribute("ry"))
      xMin = getX(shape2) - rx
      yMin = getY(shape2) - ry
      xMax = getX(shape2) + rx
      yMax = getY(shape2) + ry
    } else {
      var r = parseFloat(shape2.getAttribute("r"))
      xMin = getX(shape2) - r
      yMin = getY(shape2) - r
      xMax = getX(shape2) + r
      yMax = getY(shape2) + r
    }
  } else {
    throw "Oops, that kind of shape isn't supported by the collide function!"
  }
  return (centerX > xMin &&
          centerX < xMax &&
         centerY > yMin &&
         centerY < yMax)
}
